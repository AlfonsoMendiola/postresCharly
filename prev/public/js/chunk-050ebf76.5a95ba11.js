(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-050ebf76"],{"00f9":function(t,a,e){"use strict";e.r(a);var o=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"container"},[e("h1",[t._v("Usuarios")]),e("b-alert",{attrs:{show:t.dismissCountDown,dismissible:"",variant:t.mensaje.color},on:{dismissed:function(a){t.dismissCountDown=0},"dismiss-count-down":t.countDownChanged}},[t._v(" "+t._s(t.mensaje.texto)+" ")]),t.editar?e("form",{on:{submit:function(a){return a.preventDefault(),t.editarUsuario(t.usuarioEditar)}}},[e("h3",[t._v("Editar Usuario")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.usuarioEditar.nombre,expression:"usuarioEditar.nombre"}],staticClass:"form-control my-2",attrs:{type:"text",placeholder:"Nombre"},domProps:{value:t.usuarioEditar.nombre},on:{input:function(a){a.target.composing||t.$set(t.usuarioEditar,"nombre",a.target.value)}}}),e("input",{directives:[{name:"model",rawName:"v-model",value:t.usuarioEditar.email,expression:"usuarioEditar.email"}],staticClass:"form-control my-2",attrs:{type:"text",placeholder:"Email"},domProps:{value:t.usuarioEditar.email},on:{input:function(a){a.target.composing||t.$set(t.usuarioEditar,"email",a.target.value)}}}),e("input",{directives:[{name:"model",rawName:"v-model",value:t.usuarioEditar.pass,expression:"usuarioEditar.pass"}],staticClass:"form-control my-2",attrs:{type:"text",placeholder:"Contraseña"},domProps:{value:t.usuarioEditar.pass},on:{input:function(a){a.target.composing||t.$set(t.usuarioEditar,"pass",a.target.value)}}}),e("label",[t._v("Vista:")]),e("select",{directives:[{name:"model",rawName:"v-model",value:t.usuarioEditar.vista,expression:"usuarioEditar.vista"}],staticClass:"form-control my-2",on:{change:function(a){var e=Array.prototype.filter.call(a.target.options,(function(t){return t.selected})).map((function(t){var a="_value"in t?t._value:t.value;return a}));t.$set(t.usuarioEditar,"vista",a.target.multiple?e:e[0])}}},[e("option",{attrs:{value:"tienda"}},[t._v("Tienda")])]),e("label",[t._v("Role:")]),e("select",{directives:[{name:"model",rawName:"v-model",value:t.usuarioEditar.role,expression:"usuarioEditar.role"}],staticClass:"form-control my-2",on:{change:function(a){var e=Array.prototype.filter.call(a.target.options,(function(t){return t.selected})).map((function(t){var a="_value"in t?t._value:t.value;return a}));t.$set(t.usuarioEditar,"role",a.target.multiple?e:e[0])}}},[e("option",{attrs:{value:"USER"}},[t._v("Usuario")]),e("option",{attrs:{value:"ADMIN"}},[t._v("Administrador")])]),e("label",[t._v("Activo:")]),e("select",{directives:[{name:"model",rawName:"v-model",value:t.usuarioEditar.activo,expression:"usuarioEditar.activo"}],staticClass:"form-control my-2",on:{change:function(a){var e=Array.prototype.filter.call(a.target.options,(function(t){return t.selected})).map((function(t){var a="_value"in t?t._value:t.value;return a}));t.$set(t.usuarioEditar,"activo",a.target.multiple?e:e[0])}}},[e("option",{attrs:{value:"true"}},[t._v("Sí")]),e("option",{attrs:{value:"false"}},[t._v("No")])]),e("button",{staticClass:"btn btn-success my-1 mx-2",attrs:{type:"submit"}},[t._v("Editar")]),e("button",{staticClass:"btn btn-secondary my-1",attrs:{type:"submit"},on:{click:function(a){t.editar=!1}}},[t._v("Cancelar")])]):t._e(),t.editar?t._e():e("form",{on:{submit:function(a){return a.preventDefault(),t.agregarUsuario()}}},[e("h3",[t._v("Agregar nuevo usuario")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.usuario.nombre,expression:"usuario.nombre"}],staticClass:"form-control my-2",attrs:{type:"text",placeholder:"Nombre"},domProps:{value:t.usuario.nombre},on:{input:function(a){a.target.composing||t.$set(t.usuario,"nombre",a.target.value)}}}),e("input",{directives:[{name:"model",rawName:"v-model",value:t.usuario.email,expression:"usuario.email"}],staticClass:"form-control my-2",attrs:{type:"text",placeholder:"Email"},domProps:{value:t.usuario.email},on:{input:function(a){a.target.composing||t.$set(t.usuario,"email",a.target.value)}}}),e("input",{directives:[{name:"model",rawName:"v-model",value:t.usuario.pass,expression:"usuario.pass"}],staticClass:"form-control my-2",attrs:{type:"text",placeholder:"Contraseña"},domProps:{value:t.usuario.pass},on:{input:function(a){a.target.composing||t.$set(t.usuario,"pass",a.target.value)}}}),e("label",[t._v("Vista:")]),e("select",{directives:[{name:"model",rawName:"v-model",value:t.usuario.vista,expression:"usuario.vista"}],staticClass:"form-control my-2",on:{change:function(a){var e=Array.prototype.filter.call(a.target.options,(function(t){return t.selected})).map((function(t){var a="_value"in t?t._value:t.value;return a}));t.$set(t.usuario,"vista",a.target.multiple?e:e[0])}}},[e("option",{attrs:{value:"tienda"}},[t._v("Tienda")])]),e("label",[t._v("Role:")]),e("select",{directives:[{name:"model",rawName:"v-model",value:t.usuario.role,expression:"usuario.role"}],staticClass:"form-control my-2",on:{change:function(a){var e=Array.prototype.filter.call(a.target.options,(function(t){return t.selected})).map((function(t){var a="_value"in t?t._value:t.value;return a}));t.$set(t.usuario,"role",a.target.multiple?e:e[0])}}},[e("option",{attrs:{value:"USER"}},[t._v("Usuario")]),e("option",{attrs:{value:"ADMIN"}},[t._v("Administrador")])]),e("label",[t._v("Activo:")]),e("select",{directives:[{name:"model",rawName:"v-model",value:t.usuario.activo,expression:"usuario.activo"}],staticClass:"form-control my-2",on:{change:function(a){var e=Array.prototype.filter.call(a.target.options,(function(t){return t.selected})).map((function(t){var a="_value"in t?t._value:t.value;return a}));t.$set(t.usuario,"activo",a.target.multiple?e:e[0])}}},[e("option",{attrs:{value:"true"}},[t._v("Sí")]),e("option",{attrs:{value:"false"}},[t._v("No")])]),t._m(0)]),e("table",{staticClass:"table"},[t._m(1),e("tbody",t._l(t.usuarios,(function(a,o){return e("tr",{key:o},[e("td",[t._v(t._s(t.formatearFecha(a.date)))]),e("td",[t._v(t._s(a.nombre))]),e("td",[t._v(t._s(a.email))]),e("td",[t._v(t._s(a.vista))]),e("td",[t._v(t._s(a.role))]),e("td",[t._v(t._s(a.activo?"Sí":"No"))]),e("td",[e("b-button",{staticClass:"btn-danger btn-sm",on:{click:function(e){return t.eliminarUsuario(a._id)}}},[t._v("Eliminar")]),e("b-button",{staticClass:"btn-primary btn-sm m-1",on:{click:function(e){return t.activarEdicion(a._id)}}},[t._v("Editar")])],1)])})),0)]),e("nav",{attrs:{"aria-label":"Page navigation example"}},[e("ul",{staticClass:"pagination"},[e("li",{staticClass:"page-item",class:{disabled:1===t.paginaActual}},[e("router-link",{staticClass:"page-link",attrs:{to:{query:{pagina:t.paginaActual-1}}}},[t._v(" Anterior ")])],1),t._l(t.cantidadPaginas,(function(a,o){return e("li",{key:o,staticClass:"page-item",class:{active:t.paginaActual===o+1}},[e("router-link",{staticClass:"page-link",attrs:{to:{query:{pagina:o+1}}}},[t._v(t._s(o+1))])],1)})),e("li",{staticClass:"page-item",class:{disabled:t.paginaActual===t.cantidadPaginas}},[e("router-link",{staticClass:"page-link",attrs:{to:{query:{pagina:t.paginaActual+1}}}},[t._v(" Siguiente ")])],1)],2)])],1)},s=[function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"d-grid gap-2"},[e("button",{staticClass:"btn btn-success my-2",attrs:{type:"submit"}},[t._v("Agregar")])])},function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("thead",[e("tr",[e("th",{attrs:{scope:"col"}},[t._v("Registro")]),e("th",{attrs:{scope:"col"}},[t._v("Nombre")]),e("th",{attrs:{scope:"col"}},[t._v("email")]),e("th",{attrs:{scope:"col"}},[t._v("Vista")]),e("th",{attrs:{scope:"col"}},[t._v("Role")]),e("th",{attrs:{scope:"col"}},[t._v("Activo")]),e("th",{attrs:{scope:"col"}},[t._v("Acciones")])])])}],i=e("5530"),r=(e("99af"),e("c740"),e("a434"),e("2f62")),n=e("c1df"),u=e.n(n),l={data:function(){return{totalUsuarios:0,limite:50,paginaActual:1,usuarios:[],dismissSecs:5,dismissCountDown:0,mensaje:{color:"",texto:""},usuario:{nombre:"",email:"",pass:"",vista:"",role:"",activo:!0},usuarioEditar:{},editar:!1}},computed:Object(i["a"])(Object(i["a"])({},Object(r["d"])(["token","usuarioDB"])),{},{cantidadPaginas:function(){return Math.ceil(this.totalUsuarios/this.limite)}}),methods:{alerta:function(){this.mensaje.color="success",this.mensaje.texto="Probando alerta",this.showAlert()},paginacion:function(t){var a=this,e={headers:{token:this.token}},o=(t-1)*this.limite;this.axios.get("/usuario?limite=".concat(this.limite,"&skip=").concat(o),e).then((function(t){a.usuarios=t.data.usuarioDB,a.totalUsuarios=t.data.totalUsuarios})).catch((function(t){console.log(t.response)}))},agregarUsuario:function(){var t=this,a={headers:{token:this.token}};this.axios.post("/nuevo-usuario",this.usuario,a).then((function(a){t.usuarios.push(a.data),t.usuario.nombre="",t.usuario.email="",t.usuario.pass="",t.usuario.vista="",t.usuario.activo=!0,t.mensaje.color="success",t.mensaje.texto="Usuario agregado",t.showAlert()})).catch((function(a){console.log(a.response),a.response.data.errors.nombre.message?t.mensaje.texto=a.response.data.errors.nombre.message:t.mensaje.texto="Error de sistema",t.mensaje.color="danger",t.showAlert()}))},eliminarUsuario:function(t){var a=this,e={headers:{token:this.token}};this.axios.delete("/usuario/".concat(t),e).then((function(t){var e=a.usuarios.findIndex((function(a){return a._id===t.data._id}));a.usuarios.splice(e,1),a.mensaje.color="success",a.mensaje.texto="Usuario eliminado",a.showAlert()})).catch((function(t){a.mensaje.color="danger",a.mensaje.texto="Error al eliminar",a.showAlert()}))},activarEdicion:function(t){var a=this;this.editar=!0;var e={headers:{token:this.token}};this.axios.get("/usuario/".concat(t),e).then((function(t){a.usuarioEditar=t.data})).catch((function(t){console.log(t),a.editar=!1,a.mensaje.color="danger",a.mensaje.texto="Error obtener usuario"}))},editarUsuario:function(t){var a=this,e={headers:{token:this.token}};this.axios.put("/usuario/".concat(t._id),t,e).then((function(t){var e=a.usuarios.findIndex((function(a){return a._id===t.data._id}));a.usuarios[e].nombre=t.data.nombre,a.usuarios[e].email=t.data.email,a.usuarios[e].pass=t.data.pass,a.usuarios[e].vista=t.data.vista,a.usuarios[e].role=t.data.role,a.usuarios[e].activo=t.data.activo,a.mensaje.color="success",a.mensaje.texto="Usuario Actualizado",a.showAlert(),a.editar=!1})).catch((function(t){console.log(t.response),a.mensaje.color="danger",a.mensaje.texto="No fue posible editar la informacion del usuario",a.showAlert()}))},countDownChanged:function(t){this.dismissCountDown=t},showAlert:function(){this.dismissCountDown=this.dismissSecs},formatearFecha:function(t){return u.a.locale("es-mx"),u()(t).format("L")}},watch:{"$route.query.pagina":{immediate:!0,handler:function(t){t=parseInt(t)||1,this.paginacion(t),this.paginaActual=t}}}},c=l,m=e("2877"),d=Object(m["a"])(c,o,s,!1,null,null,null);a["default"]=d.exports},a434:function(t,a,e){"use strict";var o=e("23e7"),s=e("da84"),i=e("23cb"),r=e("5926"),n=e("07fa"),u=e("7b0b"),l=e("65f0"),c=e("8418"),m=e("1dde"),d=m("splice"),v=s.TypeError,p=Math.max,f=Math.min,h=9007199254740991,g="Maximum allowed length exceeded";o({target:"Array",proto:!0,forced:!d},{splice:function(t,a){var e,o,s,m,d,_,b=u(this),y=n(b),x=i(t,y),E=arguments.length;if(0===E?e=o=0:1===E?(e=0,o=y-x):(e=E-2,o=f(p(r(a),0),y-x)),y+e-o>h)throw v(g);for(s=l(b,o),m=0;m<o;m++)d=x+m,d in b&&c(s,m,b[d]);if(s.length=o,e<o){for(m=x;m<y-o;m++)d=m+o,_=m+e,d in b?b[_]=b[d]:delete b[_];for(m=y;m>y-o+e;m--)delete b[m-1]}else if(e>o)for(m=y-o;m>x;m--)d=m+o-1,_=m+e-1,d in b?b[_]=b[d]:delete b[_];for(m=0;m<e;m++)b[m+x]=arguments[m+2];return b.length=y-o+e,s}})},c740:function(t,a,e){"use strict";var o=e("23e7"),s=e("b727").findIndex,i=e("44d2"),r="findIndex",n=!0;r in[]&&Array(1)[r]((function(){n=!1})),o({target:"Array",proto:!0,forced:n},{findIndex:function(t){return s(this,t,arguments.length>1?arguments[1]:void 0)}}),i(r)}}]);
//# sourceMappingURL=chunk-050ebf76.5a95ba11.js.map